{
  "pluginAlias": "FourHeat4Way",
  "pluginType": "platform",
  "singular": true,
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "title": "Accessory Name",
        "type": "string",
        "default": "4HEAT Stove"
      },
      "host": {
        "title": "Device IP Address",
        "type": "string",
        "description": "Leave empty for auto-discovery via UDP broadcast"
      },
      "port": {
        "title": "TCP Port",
        "type": "integer",
        "default": 80,
        "minimum": 1,
        "maximum": 65535
      },
      "pollingInterval": {
        "title": "Polling Interval (seconds)",
        "type": "integer",
        "default": 30,
        "minimum": 5,
        "maximum": 300,
        "description": "How often to poll the device for status updates"
      },
      "minTemp": {
        "title": "Minimum Temperature (°C)",
        "type": "integer",
        "default": 30,
        "minimum": 0,
        "maximum": 100
      },
      "maxTemp": {
        "title": "Maximum Temperature (°C)",
        "type": "integer",
        "default": 75,
        "minimum": 0,
        "maximum": 100
      },
      "logLevel": {
        "title": "Log Level",
        "type": "string",
        "default": "normal",
        "oneOf": [
          { "title": "Normal — events & errors only", "enum": ["normal"] },
          { "title": "Verbose — every poll cycle", "enum": ["verbose"] },
          { "title": "Debug — verbose + TCP traffic", "enum": ["debug"] }
        ],
        "description": "Controls how much information is written to the Homebridge log"
      },
      "switchDebounce": {
        "title": "On/Off Debounce (seconds)",
        "type": "integer",
        "default": 0,
        "minimum": 0,
        "maximum": 30,
        "description": "Delay before executing on/off command. If reversed within this time, the command is cancelled. Set to 0 to disable."
      },
      "cronoSwitch": {
        "title": "Schedule Switch (Crono)",
        "type": "boolean",
        "default": false,
        "description": "Show a switch in HomeKit to enable/disable the stove's built-in timer schedule. Schedule must be configured using the 4HEAT app."
      },
      "cronoName": {
        "title": "Schedule Switch Name",
        "type": "string",
        "default": "Schedule",
        "description": "Display name for the crono switch in Apple Home",
        "condition": { "functionBody": "return model.cronoSwitch === true;" }
      },
      "alertSensor": {
        "title": "Alert Sensor (SmokeSensor)",
        "type": "boolean",
        "default": false,
        "description": "Show a smoke sensor in HomeKit that triggers on critical stove errors (Block, Safety Mode). Sends push notifications to your iPhone."
      },
      "sensors": {
        "title": "Sensors",
        "type": "object",
        "properties": {
          "exhaustTemp": {
            "title": "Exhaust Temperature (0xFFFF)",
            "type": "boolean",
            "default": false,
            "description": "Flue gas / exhaust temperature sensor"
          },
          "roomTemp": {
            "title": "Room Temperature (0xFFF7)",
            "type": "boolean",
            "default": false,
            "description": "Room ambient temperature sensor"
          },
          "boilerTemp": {
            "title": "Boiler Temperature (0xFFFC)",
            "type": "boolean",
            "default": false,
            "description": "Boiler water temperature sensor"
          },
          "dhwTemp": {
            "title": "DHW Temperature (0xFFE2)",
            "type": "boolean",
            "default": false,
            "description": "Domestic hot water temperature sensor"
          },
          "bufferTemp": {
            "title": "Buffer Temperature (0xFFFA)",
            "type": "boolean",
            "default": false,
            "description": "Buffer tank temperature sensor"
          },
          "flowTemp": {
            "title": "Flow Temperature (0xFFE4)",
            "type": "boolean",
            "default": false,
            "description": "Heating circuit flow temperature sensor"
          },
          "externalTemp": {
            "title": "External Temperature (0xFFF6)",
            "type": "boolean",
            "default": false,
            "description": "Outdoor ambient temperature sensor"
          },
          "waterPressure": {
            "title": "Water Pressure (0xFFFB)",
            "type": "boolean",
            "default": false,
            "description": "Water pressure sensor (displayed as humidity 0-100%)"
          },
          "flameLight": {
            "title": "Flame Light (0xFFFD)",
            "type": "boolean",
            "default": false,
            "description": "Flame light / photocell sensor (displayed as light level)"
          },
          "airFlow": {
            "title": "Air Flow (0xFFED)",
            "type": "boolean",
            "default": false,
            "description": "Combustion air flow sensor (displayed as light level)"
          }
        }
      }
    },
    "required": ["name"]
  },
  "layout": [
    {
      "type": "fieldset",
      "title": "Connection",
      "items": ["name", "host", "port", "pollingInterval", "logLevel"]
    },
    {
      "type": "fieldset",
      "title": "Thermostat",
      "items": ["minTemp", "maxTemp", "switchDebounce", "cronoSwitch", "cronoName", "alertSensor"]
    },
    {
      "type": "fieldset",
      "title": "Sensors",
      "expandable": true,
      "expanded": false,
      "items": [
        "sensors.exhaustTemp",
        "sensors.roomTemp",
        "sensors.boilerTemp",
        "sensors.dhwTemp",
        "sensors.bufferTemp",
        "sensors.flowTemp",
        "sensors.externalTemp",
        "sensors.waterPressure",
        "sensors.flameLight",
        "sensors.airFlow"
      ]
    }
  ]
}
